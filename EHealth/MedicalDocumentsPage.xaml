<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="EHealthApp.MedicalDocumentsPage"
    Title="Documente medicale"
    BackgroundColor="White">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <!-- Buton adaugă document -->
            <Button
                Text="Adaugă document medical"
                Clicked="OnAddMedicalDocumentClicked"
                BackgroundColor="#2E7D32"
                TextColor="White"
                CornerRadius="12"
                HeightRequest="50"
                HorizontalOptions="Fill" />

            <!-- Titlu categorii -->
            <Label
                Text="Categorii:"
                FontAttributes="Bold"
                FontSize="18"
                TextColor="#2E7D32" />

            <!-- Lista categorii -->
            <CollectionView
                x:Name="CategoriesCollectionView"
                ItemsSource="{Binding Categories}"
                SelectionMode="Single"
                SelectedItem="{Binding SelectedCategory, Mode=TwoWay}"
                HeightRequest="60">
                <CollectionView.ItemsLayout>
                    <LinearItemsLayout Orientation="Horizontal" ItemSpacing="12" />
                </CollectionView.ItemsLayout>
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame
                            Padding="16,8"
                            CornerRadius="18"
                            HasShadow="False"
                            BackgroundColor="#81C784"
                            BorderColor="#388E3C">
                            <VisualStateManager.VisualStateGroups>
                                <VisualStateGroup Name="CommonStates">
                                    <VisualState Name="Normal">
                                        <VisualState.Setters>
                                            <Setter Property="BackgroundColor" Value="#81C784" />
                                            <Setter Property="BorderColor" Value="#388E3C" />
                                        </VisualState.Setters>
                                    </VisualState>
                                    <VisualState Name="Selected">
                                        <VisualState.Setters>
                                            <Setter Property="BackgroundColor" Value="#388E3C" />
                                            <Setter Property="BorderColor" Value="#1B5E20" />
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateManager.VisualStateGroups>
                            <Label
                                Text="{Binding Name}"
                                TextColor="White"
                                FontAttributes="Bold"
                                FontSize="14"
                                HorizontalOptions="Center"
                                VerticalOptions="Center" />
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <!-- Titlu documente -->
            <Label
                Text="Documente:"
                FontAttributes="Bold"
                FontSize="18"
                TextColor="#2E7D32" />

            <!-- Lista documente -->
            <CollectionView
                x:Name="DocumentsCollectionView"
                ItemsSource="{Binding FilteredDocuments}">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Frame
                            Margin="0,4"
                            Padding="12"
                            CornerRadius="12"
                            BorderColor="#C8E6C9"
                            BackgroundColor="#F1F8E9">
                            <VerticalStackLayout Spacing="8">
                                <Label
                                    Text="{Binding FileName}"
                                    FontSize="16"
                                    FontAttributes="Bold"
                                    TextColor="#2E7D32" />

                                <HorizontalStackLayout Spacing="12">
                                    <Button
                                        Text="Share"
                                        Clicked="OnShareClicked"
                                        CommandParameter="{Binding FilePath}"
                                        BackgroundColor="White"
                                        TextColor="#388E3C"
                                        CornerRadius="8"
                                        Padding="12,6"
                                        BorderColor="#81C784"
                                        BorderWidth="1" />

                                    <Button
                                        Text="Descarcă"
                                        Clicked="OnDownloadClicked"
                                        CommandParameter="{Binding FilePath}"
                                        BackgroundColor="White"
                                        TextColor="#388E3C"
                                        CornerRadius="8"
                                        Padding="12,6"
                                        BorderColor="#81C784"
                                        BorderWidth="1" />
                                </HorizontalStackLayout>
                            </VerticalStackLayout>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>

                <CollectionView.EmptyView>
                    <Label
                        Text="Nu există documente în această categorie."
                        FontAttributes="Italic"
                        TextColor="Gray"
                        HorizontalOptions="Center"
                        VerticalOptions="Center"
                        Padding="12" />
                </CollectionView.EmptyView>
            </CollectionView>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
